
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>PyBDA</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting started" href="usage.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pybda">
<h1>PyBDA<a class="headerlink" href="#pybda" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="http://www.repostatus.org/#wip"><img alt="Status" src="http://www.repostatus.org/badges/latest/wip.svg" /></a>
<a class="reference external image-reference" href="https://travis-ci.org/cbg-ethz/pybda/"><img alt="Travis" src="https://img.shields.io/travis/cbg-ethz/pybda/master.svg?&amp;logo=travis" /></a>
<a class="reference external image-reference" href="https://circleci.com/gh/cbg-ethz/pybda"><img alt="CircleCI" src="https://img.shields.io/circleci/project/github/cbg-ethz/pybda/master.svg?&amp;logo=circleci" /></a>
<a class="reference external image-reference" href="https://codecov.io/gh/cbg-ethz/pybda"><img alt="Codecov" src="https://codecov.io/gh/cbg-ethz/pybda/branch/master/graph/badge.svg" /></a>
<a class="reference external image-reference" href="https://www.codacy.com/app/simon-dirmeier/pybda?utm_source=github.com&amp;amp;utm_medium=referral&amp;amp;utm_content=cbg-ethz/pybda&amp;amp;utm_campaign=Badge_Grade"><img alt="Codacy" src="https://api.codacy.com/project/badge/Grade/a4cca665933a4def9c2cfc88d7bbbeae" /></a>
<a class="reference external image-reference" href="https://pybda.readthedocs.io/en/latest/?badge=latest"><img alt="Documentation" src="https://readthedocs.org/projects/pybda/badge/?version=latest" /></a>
<a class="reference external image-reference" href="http://bioconda.github.io/recipes/pybda/README.html"><img alt="Bioconda" src="https://img.shields.io/badge/install%20with-bioconda-brightgreen.svg?style=flat" /></a>
<a class="reference external image-reference" href="https://pypi.org/project/pybda/"><img alt="PyPi" src="https://img.shields.io/pypi/v/pybda.svg?colorB=black&amp;style=flat" /></a>
<p>A commandline tool for analysis of big biological data sets for distributed HPC clusters.</p>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="about">
<h2>About<a class="headerlink" href="#about" title="Permalink to this headline">¶</a></h2>
<p>Welcome to PyBDA.</p>
<p>PyBDA is a Python library and command line tool for big data analytics and machine learning.</p>
<p>In order to make PyBDA scale to big data sets, we use Apache <a class="reference internal" href="#spark" id="id1"><span>[Spark]</span></a>’s DataFrame API which, if developed against, automatically distributes
data to the nodes of a high-performance cluster and does the computation of expensive machine learning tasks in parallel.
For scheduling, PyBDA uses <a class="reference internal" href="#snakemake" id="id2"><span>[Snakemake]</span></a> to automatically execute pipelines of jobs. In particular, PyBDA will first build a DAG of methods/jobs
you want to execute in succession (e.g. dimensionality reduction into clustering) and then compute every method by traversing the DAG.
In the case of a successful computation of a job, PyBDA will write results and plots, and create some statistics. If one of the jobs fails PyBDA will report where and which method failed
(owing to Snakemake’s scheduling) such that the same pipeline can effortlessly be continued from where it failed the last time.</p>
<p>PyBDA supports multiple machine learning methods that scale to big data sets which we either implemented from scratch entirely or interface the methodology from <a class="reference internal" href="#mllib" id="id3"><span>[MLLib]</span></a>:</p>
<ul class="simple">
<li><p>dimensionality reduction using PCA, factor analysis, kPCA, linear discriminant analysis and ICA,</p></li>
<li><p>clustering using k-means and Gaussian mixture models,</p></li>
<li><p>supervised learning using generalized linear regression models, random forests and gradient boosting.</p></li>
</ul>
<p>The package is actively developed. If you want to you can also contribute, for instance by adding new features or methods:
<a class="reference external" href="https://github.com/cbg-ethz/pybda">fork us on GitHub</a>.</p>
</div>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Apache Spark == 2.4.0</p></li>
<li><p>Python == 3.6</p></li>
<li><p>Linux or MacOS</p></li>
</ul>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>To run PyBDA you only need to provide a config-file and, if possible, the IP of a spark-cluster (otherwise you can just call PyBDA locally using <code class="docutils literal notranslate"><span class="pre">local</span></code>).
The config file for several machine learning tasks might look like this:</p>
<div class="literal-block-wrapper docutils container" id="pybda-usecase-config">
<div class="code-block-caption"><span class="caption-text">Example of a configuration file.</span><a class="headerlink" href="#pybda-usecase-config" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spark</span><span class="p">:</span> <span class="n">spark</span><span class="o">-</span><span class="n">submit</span>
<span class="n">infile</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">single_cell_imaging_data</span><span class="o">.</span><span class="n">tsv</span>
<span class="n">predict</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">single_cell_imaging_data</span><span class="o">.</span><span class="n">tsv</span>
<span class="n">outfolder</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">results</span>
<span class="n">meta</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">meta_columns</span><span class="o">.</span><span class="n">tsv</span>
<span class="n">features</span><span class="p">:</span> <span class="n">data</span><span class="o">/</span><span class="n">feature_columns</span><span class="o">.</span><span class="n">tsv</span>
<span class="n">dimension_reduction</span><span class="p">:</span> <span class="n">pca</span>
<span class="n">n_components</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">clustering</span><span class="p">:</span> <span class="n">kmeans</span>
<span class="n">n_centers</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">200</span>
<span class="n">regression</span><span class="p">:</span> <span class="n">forest</span>
<span class="n">family</span><span class="p">:</span> <span class="n">binomial</span>
<span class="n">response</span><span class="p">:</span> <span class="n">is_infected</span>
<span class="n">sparkparams</span><span class="p">:</span>
  <span class="o">-</span> <span class="s2">&quot;--driver-memory=3G&quot;</span>
  <span class="o">-</span> <span class="s2">&quot;--executor-memory=6G&quot;</span>
<span class="n">debug</span><span class="p">:</span> <span class="n">true</span>
</pre></div>
</div>
</div>
<p>The above configuration would tell PyBDA to execute multiple things:</p>
<ul class="simple">
<li><p>first use an PCA to embed the data into a 5-dimensional latent space,</p></li>
<li><p>do a <code class="docutils literal notranslate"><span class="pre">k</span></code>-means clustering with different numbers of clusters centers on that space,</p></li>
<li><p>fit a random forest to the response called <code class="docutils literal notranslate"><span class="pre">is_infected</span></code> and use a <code class="docutils literal notranslate"><span class="pre">binomial</span></code> family,</p></li>
<li><p>give the Spark driver 3Gb of memory and the executor 6Gb,</p></li>
<li><p>print debug information.</p></li>
</ul>
<p>You call PyBDA like that:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pybda run data/pybda-usecase.config <span class="nb">local</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">local</span></code> tells PyBDA to just use your desktop as Spark cluster.</p>
<p>The result of any PyBDA call creates several files and figures. For instance, we
should check the performance of the forest:</p>
<div class="literal-block-wrapper docutils container" id="rf-tsv">
<div class="code-block-caption"><span class="caption-text">Performance statistics of the random forest.</span><a class="headerlink" href="#rf-tsv" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">family</span>	<span class="n">response</span>	<span class="n">accuracy</span>	<span class="n">f1</span>	<span class="n">precision</span>	<span class="n">recall</span>
<span class="n">binomial</span>	<span class="n">is_infected</span>	<span class="mf">0.8236</span>	<span class="mf">0.8231143143597965</span>	<span class="mf">0.8271935801788475</span>	<span class="mf">0.8236</span>
</pre></div>
</div>
</div>
<p>For the PCA, we for instance create a biplot. It’s always informative to look at these:</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/pca-biplot.svg"><img alt="_images/pca-biplot.svg" height="425px" src="_images/pca-biplot.svg" /></a>
<p class="caption"><span class="caption-text">PCA biplot of the single-cell imaging data.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>And for the consecutive clustering, two of the plots generated from the clustering are shown below:</p>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="_images/kmeans-profile.svg"><img alt="_images/kmeans-profile.svg" height="425px" src="_images/kmeans-profile.svg" /></a>
<p class="caption"><span class="caption-text">Number of clusters vs explained variance and BIC.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id6">
<a class="reference internal image-reference" href="_images/kmeans-cluster_sizes-histogram.svg"><img alt="_images/kmeans-cluster_sizes-histogram.svg" height="325px" src="_images/kmeans-cluster_sizes-histogram.svg" /></a>
<p class="caption"><span class="caption-text">Distribution of the number of cells per cluster (component).</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="citation">
<dt class="label" id="snakemake"><span class="brackets"><a class="fn-backref" href="#id2">Snakemake</a></span></dt>
<dd><p><a class="reference external" href="https://doi.org/10.1093/bioinformatics/bts480">Köster, Johannes, and Sven Rahmann. “Snakemake—a scalable bioinformatics workflow engine.” Bioinformatics 28.19 (2012): 2520-2522.</a></p>
</dd>
<dt class="label" id="spark"><span class="brackets"><a class="fn-backref" href="#id1">Spark</a></span></dt>
<dd><p><a class="reference external" href="https://doi.org/10.1145/2934664">Zaharia, Matei, et al. “Apache Sspark: a unified engine for big data processing.” Communications of the ACM 59.11 (2016): 56-65.</a></p>
</dd>
<dt class="label" id="mllib"><span class="brackets"><a class="fn-backref" href="#id3">MLLib</a></span></dt>
<dd><p><a class="reference external" href="http://jmlr.org/papers/volume17/15-237/15-237.pdf">Meng, Xiangrui, et al. “MLlib: Machine Learning in Apache Spark.” The Journal of Machine Learning Research 17.1 (2016): 1235-1241.</a></p>
</dd>
</dl>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo">
    <a href="#">
        <img src="_static/sticker_pybda.png"
             title="PyBDA"/>
    </a>
</p><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
      rel="stylesheet"
      integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
      crossorigin="anonymous">

<h3>Contents</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>

<hr>
<ul>
    <li>
        <a href="https://github.com/cbg-ethz/pybda" style="text-decoration : none">
            <i class="fa fa-github-square fa-3x" aria-hidden="true" style="vertical-align :middle;"></i>
            <span style="vertical-align: middle; font-size: 1.3rem">GitHub</span>
        </a>
    </li>
</ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018-2019, Simon Dirmeier.
      
    </div>

    

    
  </body>
</html>