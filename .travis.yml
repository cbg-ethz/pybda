language: python

sudo: required
cache: packages

python:
  - "3.6"

env:
  global:
    - SPARK_VERSION="2.4.0"
    - HADOOP_VERSION="2.7"
    - SPARK_PATH="spark-${SPARK_VERSION}-bin-hadoop${HADOOP_VERSION}"
    - SPARK_HOME="/tmp/${SPARK_PATH}"
    - JAVA_VERSION=oraclejdk8
    - PATH="${PATH}:${SPARK_HOME}/bin"

before_install:
  - pip install --upgrade pip
  - curl -s https://raw.githubusercontent.com/dirmeier/spark-travis/master/setup_spark.sh | bash

install:
  - pip install -r requirements.txt
  - pip install -e .
  - pip install codecov
  - pip install pytest-cov
  - pip install tox-travis

script:
  - py.test --cov=./
  - spark-submit -h

after_success:
  - codecov
